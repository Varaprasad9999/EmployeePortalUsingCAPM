FUNCTION "FN_NONWEEKSCALAR"(STARTDATE DATE, ENDDATE DATE)
RETURNS NONWEEKDAYS2 INTEGER
LANGUAGE SQLSCRIPT 
SQL SECURITY INVOKER AS

BEGIN
DECLARE i INTEGER;
DECLARE CURRENTDATE DATE;

i = 0;
NONWEEKDAYS2 = 0;
CURRENTDATE = ADD_DAYS(:STARTDATE, i);

WHILE CURRENTDATE <= :ENDDATE DO
    IF WEEKDAY(CURRENTDATE) IN (5, 6) THEN
        -- Sunday (6) or Saturday (5)
         NONWEEKDAYS2 = NONWEEKDAYS2 + 1;
    END IF;

     i = i + 1;
     CURRENTDATE = ADD_DAYS(:STARTDATE, i);
END WHILE;


END;